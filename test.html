<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Resilient Swarm Test</title>
    <script src="bundle.js"></script>

    <script>
      console.log("in script")
      let node1 = new Swarm('http://localhost:6688')
      let node2 = new Swarm('http://localhost:6688')
      node1.once('signal', () => {
        node2.signal(node1.publicKey)
      })
      node1.once('ready', () => {
        node2.call(node1.publicKey)
      })

      node1.on('peer', peer => console.log('peer1 got', peer.publicKey))
      node2.on('peer', peer => console.log('peer2 got', peer.publicKey))
      var starttime = Date.now()
      node1.once('peer', peer => {
        var node3 = new Swarm('http://localhost:6688')
        node3.call(node1.publicKey)
        node3.on('peer', peer => {
          console.log(( (Date.now() - starttime) / 1000 ) + 's')
          console.log('peer3 got', peer.publicKey)
        })
      })

      window.node1 = node1

    //   node1.on('peer', (peer) => {
    //     console.log('new peer from peer1', peer)
    //   })
    //   node2.on('peer', (peer) => {
    //     console.log('new peer from peer2', peer)
    //   })
    // </script>
  </head>
  <body>

  </body>
</html>